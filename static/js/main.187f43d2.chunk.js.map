{"version":3,"sources":["components/tile-palette/index.jsx","components/map/index.jsx","components/sprite/index.jsx","components/actor/index.jsx","hooks/use-walk/index.js","components/player/index.jsx","hooks/use-key-press/index.js","components/app/index.jsx","hooks/use-draggable.js/index.js","index.jsx"],"names":["TilePalette","tileset","position","size","activeTile","setActiveTile","width","height","tiles","id","y","row","x","push","console","dir","style","border","top","left","zIndex","backgroundColor","src","alt","borderTop","borderRight","background","map","display","tile","onClick","Map","setTiles","dropTile","prev","clone","m","Array","length","i","slice","cloneMatrix","v","boxSizing","Sprite","image","data","h","w","backgroundImage","backgroundRepeat","backgroundPosition","Actor","sprite","step","useWalk","maxSteps","useState","setPosition","setDir","setStep","directions","down","right","up","modifer","walk","move","Player","fn","skin","e","key","replace","toLowerCase","preventDefault","useEffect","window","addEventListener","removeEventListener","Instructions","color","App","mapSize","pos","clientX","clientY","handle","document","getElementById","pointerEvents","body","useDraggable","_tiles","innerWidth","innerHeight","overflow","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.187f43d2.chunk.js","sourcesContent":["import React from \"react\";\n\nexport default function TilePalette({\n  tileset,\n  position,\n  size,\n  activeTile,\n  setActiveTile,\n}) {\n  const { width, height } = size;\n  const tiles = [];\n  let id = 0; //mutable\n\n  for (let y = 0; y < height; y = y + 32) {\n    const row = [];\n    for (let x = 0; x < width; x = x + 32) {\n      row.push({\n        x,\n        y,\n        id: id++,\n      });\n    }\n    tiles.push(row);\n  }\n  console.dir(tiles);\n\n  return (\n    <div\n      id=\"palette\"\n      style={{\n        position: \"absolute\",\n        border: \"1px solid black\",\n        top: position.y,\n        left: position.x,\n        zIndex: 100,\n        backgroundColor: \"white\",\n      }}\n    >\n      <img id=\"handle\" src=\"/img/drag-handle.png\" alt=\"\" />\n      <div\n        style={{\n          borderTop: \"1px solid black\",\n          borderRight: \"1px solid black\",\n          background: `url(/sprites/zones/${tileset}.png) -${activeTile.x}px -${activeTile.y}px no-repeat`,\n        }}\n      />\n      {tiles.map((row, y) => (\n        <div style={{ display: \"flex\" }}>\n          {row.map((tile, x) => (\n            <div\n              onClick={() => setActiveTile({ x: x * 32, y: y * 32 })}\n              style={{\n                borderTop: \"1px solid black\",\n                borderRight: \"1px solid black\",\n                background: `url(/sprites/zones/${tileset}.png) -${x * 32}px -${\n                  y * 32\n                }px no-repeat`,\n                width: 32,\n                height: 32,\n              }}\n            />\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n}\n","import { dropRightWhile } from \"lodash\";\nimport React from \"react\";\nexport default function Map({ tiles, setTiles, activeTile, tileset, size }) {\n  function cloneMatrix(m) {\n    const clone = new Array(m.length);\n    for (let i = 0; i < m.length; ++i) {\n      clone[i] = m[i].slice(0);\n    }\n    return clone;\n  }\n  function dropTile({ x, y }) {\n    setTiles((prev) => {\n      const clone = cloneMatrix(prev);\n      const tile = {\n        ...clone[y][x],\n        v: activeTile,\n      };\n      clone[y][x] = tile;\n      return clone;\n      //clone matrix, alter tile @x/y to the active tile\n    });\n  }\n  return (\n    <div\n      style={{\n        boxSizing: \"border-box\",\n        backgroundColor: \"white\",\n        width: size.width,\n      }}\n    >\n      {tiles.map((row, y) => (\n        <div style={{ display: \"flex\" }}>\n          {row.map((tile, x) => (\n            <div\n              onClick={() => dropTile({ x, y })}\n              style={{\n                borderTop: \"1px solid black\",\n                borderRight: \"1px solid black\",\n                background: `url(/sprites/zones/${tileset}.png) -${tile.v.x}px -${tile.v.y}px no-repeat`,\n                width: 32,\n                height: 32,\n              }}\n            />\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n}\n","import React from \"react\";\n\nexport default function Sprite({ image, data, position }) {\n  const { y, x, h, w } = data;\n  return (\n    <div\n      style={{\n        position: \"absolute\",\n        top: position.y,\n        left: position.x,\n        height: `${h}px`,\n        width: `${w}px`,\n        backgroundImage: `url(${image})`,\n        backgroundRepeat: \"no-repeat\",\n        backgroundPosition: `-${x}px -${y}px`,\n      }}\n    />\n  );\n}\n","import React from \"react\";\nimport Sprite from \"../sprite\";\n\nexport default function Actor({\n  sprite,\n  data,\n  position = { x: 0, y: 0 },\n  step = 0,\n  dir = 0,\n}) {\n  const { h, w } = data;\n  return (\n    <Sprite\n      image={sprite}\n      position={position}\n      data={{\n        x: step * w,\n        y: dir * h,\n        w,\n        h,\n      }}\n    />\n  );\n}\n","import { useState } from \"react\";\n\nexport default function useWalk(maxSteps) {\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [dir, setDir] = useState(0);\n  const [step, setStep] = useState(0);\n  const directions = {\n    down: 0,\n    left: 1,\n    right: 2,\n    up: 3,\n  };\n\n  const stepSize = 16;\n\n  const modifer = {\n    down: { x: 0, y: stepSize },\n    left: { x: -stepSize, y: 0 },\n    right: { x: stepSize, y: 0 },\n    up: { x: 0, y: -stepSize },\n  };\n\n  function walk(dir) {\n    console.dir(directions[dir]);\n    setDir((prev) => {\n      if (directions[dir] === prev) move(dir);\n      return directions[dir];\n    });\n\n    setStep((prev) => (prev < maxSteps - 1 ? prev + 1 : 0));\n  }\n\n  function move(dir) {\n    setPosition((prev) => ({\n      x: prev.x + modifer[dir].x,\n      y: prev.y + modifer[dir].y,\n    }));\n  }\n\n  return {\n    walk,\n    dir,\n    step,\n    position,\n  };\n}\n","import React from \"react\";\nimport Actor from \"../actor\";\nimport useKeyPress from \"../../hooks/use-key-press\";\nimport useWalk from \"../../hooks/use-walk\";\n\nexport default function Player({ skin }) {\n  const { dir, step, walk, position } = useWalk(3);\n  const data = {\n    h: 32,\n    w: 32,\n  };\n\n  useKeyPress((e) => {\n    walk(e.key.replace(\"Arrow\", \"\").toLowerCase());\n\n    e.preventDefault();\n  });\n  return (\n    <Actor\n      sprite={`/sprites/skins/${skin}.png`}\n      data={data}\n      step={step}\n      dir={dir}\n      position={position}\n    />\n  );\n}\n","import { useEffect} from \"react\";\n\nexport default function useKeyPress(fn){\n    useEffect(() =>{\n        window.addEventListener(\"keydown\",fn);\n        return() => window.removeEventListener(\"keydown\", fn);\n\n    }, [fn]);\n}","import React, { useEffect, useState } from \"react\"; // highlevel state\nimport useDraggable from \"../../hooks/use-draggable.js\";\nimport TilePalette from \"../tile-palette\";\nimport Map from \"../map\";\nimport Player from \"../player\";\n\nconst Instructions = {\n  position: \"absolute\",\n  right: \"300px\",\n  top: \"1px\",\n  width: \"300px\",\n  height: \"500px\",\n  color: \"white\",\n};\nexport default function App() {\n  const [tileset, setTileset] = useState(\"grasslands_1\");\n  const [activeTile, setActiveTile] = useState({ x: 1 * 32, y: 4 * 32 });\n  const [tiles, setTiles] = useState([]);\n  const [mapSize, setMapSize] = useState({\n    width: 800,\n    height: 600,\n  });\n\n  const { position } = useDraggable(\"handle\");\n\n  useEffect(() => {\n    // two arguments frist is the arrow function when the side effect happens and the second is the list of dependencies\n    const _tiles = []; // only used in this use effect block\n    let id = 0; //mutable value\n    for (let y = 0; y < mapSize.height; y = y + 32) {\n      //tile matrix\n      const row = [];\n      for (let x = 0; x < mapSize.width; x = x + 32) {\n        // iner for loop for width\n        row.push({ x, y, id: id++, v: { x: -32, y: -32 } }); // v is a value key  set to neg so the map will show a blank tile\n      }\n      _tiles.push(row);\n    }\n    setTiles(_tiles); // new matrix from _tiles becomes the state\n  }, []);\n\n  return (\n    <>\n      <div\n        style={{\n          position: \"absolute\",\n          width: window.innerWidth,\n          height: window.innerHeight,\n          backgroundColor: \"grey\",\n          overflow: \"hidden\",\n          border: \"1px solid black\",\n        }}\n      >\n        <Map\n          tiles={tiles}\n          tileset={tileset}\n          size={mapSize}\n          activeTile={activeTile}\n          setTiles={setTiles}\n        />\n        <div style={Instructions}>\n          <h1>Hello, take the cat for a walk please.</h1>\n          <p>\n            Just move that pesky map maker to the side and you will see him.\n            While you are at it, create a world with that map maker. (use your\n            arrow keys to move the cat)\n          </p>\n        </div>\n        <TilePalette\n          position={position}\n          tileset={tileset}\n          activeTile={activeTile}\n          setActiveTile={setActiveTile}\n          size={{\n            height: 288,\n            width: 640,\n          }}\n        />\n        <Map\n          tiles={tiles}\n          tileset={tileset}\n          size={mapSize}\n          activeTile={activeTile}\n          setTiles={setTiles}\n        />\n        <Player skin=\"Cat\" />\n      </div>\n    </>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\n\nexport default function useDraggable(id) {\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n\n  useEffect(() => {\n    const handle = document.getElementById(id);\n    handle.addEventListener(\"mousedown\", function (e) {\n      e.preventDefault();\n      handle.style.pointerEvents = \"none\";\n\n      document.body.addEventListener(\"mousemove\", move);\n      document.body.addEventListener(\"mouseup\", () => {\n        document.body.removeEventListener(\"mousemove\", move);\n        handle.style.pointerEvents = \"initial\";\n      });\n    });\n    return () => {\n      document.body.removeEventListener(\"mousedown\", move);\n      document.body.removeEventListener(\"mouseup\", move);\n      document.body.removeEventListener(\"mousemove\", move);\n    };\n  }, []);\n\n  function move(e) {\n    const pos = {\n      x: e.clientX,\n      y: e.clientY,\n    };\n    setPosition(pos);\n  }\n\n  return {\n    position,\n  };\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./components/app/index\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}